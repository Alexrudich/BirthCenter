# Тестовое задание: BirthCenter API

## 📋 Исходное задание

### 1. REST API приложение
Создать REST API приложение, которое содержит CRUD-методы для сущности Patient (рожденные в роддоме дети).

**Пример сущности в формате JSON:**
```json
{
  "id": "d8ff176f-bd0a-4b8e-b329-871952e32e1f",
  "name": {
    "use": "official",
    "family": "Иванов",
    "given": ["Иван", "Иванович"]
  },
  "gender": "male",
  "birthDate": "2024-01-13T18:25:43",
  "active": true
}
```

**Обязательные поля:**
- `name.family`
- `birthDate`

**Справочники:**
- Gender: `male` | `female` | `other` | `unknown`
- Active: `true` | `false`

**Технологии:** .NET Core, .NET 6, СУБД можно использовать любую.

### 2. Поиск по birthDate
Сделать поиск Patient по полю `birthDate` по следующим требованиям: 
[https://www.hl7.org/fhir/search.html#date](https://www.hl7.org/fhir/search.html#date)

### 3. Swagger
Добавить в проект описание методов API с помощью Swagger.

### 4. Консольное приложение
Разработать консольное приложение для добавления через API 100 сгенерированных сущностей Patient.

### 5. Docker
Создать Dockerfile и реализовать запуск разработанного программного обеспечения (включая БД) в виде docker-контейнеров.

### 6. Postman-коллекция
Сделать Postman-коллекцию для демонстрации методов:
- добавление
- редактирование
- получение по идентификатору
- удаление
- различные варианты поиска по параметру `birthDate`

### 7. Git-репозиторий
Результат выполнения тестового задания положить в открытый репозитарий git-сервера (GitHub, GitLab, etc.).

---

## ✅ Реализованные требования

### Архитектура
- ✅ Чистая архитектура (Domain, Application, Infrastructure, API)
- ✅ Инверсия зависимостей
- ✅ Глобальная обработка ошибок через Exception Handling Middleware

### API (CRUD для Patient)
- ✅ `POST /api/Patients` - создание пациента
- ✅ `GET /api/Patients` - получение всех пациентов
- ✅ `GET /api/Patients/{id}` - получение по ID
- ✅ `PUT /api/Patients/{id}` - обновление
- ✅ `DELETE /api/Patients/{id}` - удаление
- ✅ Валидация обязательных полей

### Поиск по birthDate (FHIR-совместимый)
- ✅ Поддержка префиксов: `eq`, `ne`, `gt`, `lt`, `ge`, `le`
- ✅ Поддержка частичных дат:
  - `2024` - все пациенты 2024 года
  - `2024-01` - все пациенты января 2024
  - `2024-01-13` - точная дата
- ✅ Поддержка комбинаций: `gt2024-01-01`, `le2024-12-31`

### Swagger
- ✅ Полное описание всех эндпоинтов
- ✅ XML-комментарии для параметров и ответов
- ✅ Примеры запросов и ответов
- ✅ Статус-коды для всех методов

### Docker
- ✅ Dockerfile для API
- ✅ `docker-compose.yml` с PostgreSQL
- ✅ Один контейнер для API, один для БД
- ✅ Healthcheck для PostgreSQL
- ✅ Автоматическое создание базы при запуске

### Консольное приложение (альтернативная реализация)
- ✅ SeedController для генерации тестовых данных
- ✅ `POST /api/Seed/generate` - создает 100 пациентов
- ✅ `GET /api/Seed/count` - показывает текущее количество
- ✅ `DELETE /api/Seed/clear` - очищает БД

### Postman-коллекция
- ✅ Все CRUD операции
- ✅ Различные варианты поиска по дате
- ✅ Управление тестовыми данными
- ✅ Готова к импорту (`BirthCenter.postman_collection.json`)

### Git-репозиторий
- ✅ Полная история разработки
- ✅ Чистый `main` с рабочей версией
- ✅ Ветка `develop` для разработки
- ✅ Детальный `README.md` и `TASK.md`

## 🚀 Как запустить

### Через Docker Compose (рекомендуется)
```bash
docker-compose up --build
```

После запуска:
- API: http://localhost:7000
- Swagger: http://localhost:7000/swagger

### Через Visual Studio
1. Открыть `BirthCenter.sln`
2. Выбрать профиль `docker-compose`
3. Нажать `F5`

## 📮 Postman коллекция
Файл `BirthCenter.postman_collection.json` в корне проекта.

## 📝 Примечания
- Вместо отдельного консольного приложения реализован `SeedController`, который предоставляет те же возможности через API
- Это сделано для упрощения тестирования и устранения проблем с подключением к БД
- Функциональность полностью сохранена: можно создать 100 тестовых пациентов одним запросом